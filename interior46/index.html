<!DOCTYPE html>
<html>
	<head>
		<title>DigitalVisualization > Interior 46</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
		body {
			background-color: #000000;
			margin: 0;
			font-family: Helvetica, sans-serif;;
			overflow: hidden;
		}
		a {
			color: #ffffff;
		}
		p.author {
			width: 100%;
			position: absolute;
			font-family: Monospace;
			font-size: 13px;
			text-align: center;
			color: white;
			padding-right: 80px;
		}
		.selectors {
			top: 70px;
			left: 30px;
			font-family: Monospace;
			font-size: 13px;
			position: absolute;
			color: white;
		}
		</style>
	</head>
	<body>
		<script src="../three.js/three.min.r83.js"></script>
		<script src="../three.js/OrbitControls.js"></script>

		<div id="container"></div>
		<p class="author">DigitalVisualization > FREE SAMPLE INTERIOR 46<br>
		Free 3DS Max Interior from <a href="http://3darcshop.com/3dmodel/free-sample-interior-46.html" target="_blank">http://3darcshop.com</a></p>
		<div class="selectors">
			Wall color:
			<select name="wallColorSelect" onchange="wallColorChange(this.value);">
				<option value="Brown" selected>Brown</option>
				<option value="Red" >Red</option>
				<option value="Pink" >Pink</option>
				<option value="Blue" >Blue</option>
			</select><br>
			Floor color:
			<select name="floorColorSelect" onchange="floorgColorChange(this.value);">
				<option value="Default" selected>Default</option>
				<option value="Green" >Green</option>
				<option value="Blue" >Blue</option>
			</select><br>
			Floor tiling:
			<select name="floorTileSelect" onchange="floorTileChange(this.value);">
				<option value="Default" selected>Default</option>
				<option value="A4225_2A" >A4225_2A</option>
				<option value="A4240_3A" >A4240_3A</option>
				<option value="Stone1" >Stone1</option>
				<option value="Stone2" >Stone2</option>
			</select><br>

			Wall element color:
			<select name="wallElementColorSelect" onchange="wallElementChange(this.value);">
				<option value="Brown" selected>Brown</option>
				<option value="Red" >Red</option>
			</select>
		</div>

		<script>
			var camera, controls, scene, renderer;
			var meshContainer;
			var loadingManager = new THREE.LoadingManager();
			var partMeshes = {};

			var room = {
				sizeX: 4000,
				sizeY: 7000,
				sizeZ: 3000
			}

			init();
			// animate();

			function init() {

				camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 600000 );
				camera.position.set(0, 0, 1960);
				// camera.lookAt(0, 1500, 0);
				// camera.position.y = 1500;

				scene = new THREE.Scene();
				meshContainer = new THREE.Group();
				meshContainer.position.y = -1300;
				scene.add(meshContainer);

				/*Light*/
				scene.add(new THREE.AmbientLight( 0xffffff ));

				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setSize( window.innerWidth, window.innerHeight, false );
				renderer.domElement.style.position = 'absolute';
				renderer.domElement.style.top = 0;
				document.getElementById( 'container' ).appendChild( renderer.domElement );

				controls = new THREE.OrbitControls( camera, renderer.domElement );
				// controls.target.set(0, 1500, 0);
				controls.maxDistance = 200000;
				controls.enableKeys = false;
				controls.addEventListener('change', render);

				window.addEventListener( 'resize', onWindowResize, false );

				var parts = [
					['floor.js', 'floorVRayCompleteMap.jpg'],
					// ['floor-bledn.json', 'floorVRayCompleteMap.jpg'],

					['floor-2.js', 'floor-2VRayCompleteMap.jpg'],
					['windowView.js', 'windowViewVRayCompleteMap.jpg'],
					['wall-1.js', 'wall-1VRayCompleteMap.jpg'],
					['wall-1-1.js', 'wall-1-1VRayCompleteMap.jpg'],
					['wall-1-2.js', 'wall-1-2VRayCompleteMap.jpg'],
					['wall-1-3.js', 'wall-1-3VRayCompleteMap.jpg'],
					['wall-1-4.js', 'wall-1-4VRayCompleteMap.jpg'],
					['wall-1-5.js', 'wall-1-5VRayCompleteMap.jpg'],
					['wall-1-6.js', 'wall-1-6VRayCompleteMap.jpg'],
					['wall-1-7.js', 'wall-1-7VRayCompleteMap.jpg'],
					['ceiling.js', 'ceilingVRayCompleteMap.jpg'],
					['ceiling2.js', 'ceiling2VRayCompleteMap.jpg'],
					['balconyWall.js', 'balconyWallVRayCompleteMap.jpg'],
					['balconyDoors.js', 'balconyDoorsVRayCompleteMap.jpg'],
					['socket1.js', 'socket1VRayCompleteMap.jpg'],
					['switcher1.js', 'switcher1VRayCompleteMap.jpg'],
					['switcher2.js', 'switcher2VRayCompleteMap.jpg'],
					['bed.js', 'bedVRayCompleteMap.jpg'],
					['bed2.js', 'bed2VRayCompleteMap.jpg'],
					['light.js', 'lightVRayCompleteMap.jpg'],
					['light2.js', 'light2VRayCompleteMap.jpg'],
					['light3.js', 'light3VRayCompleteMap.jpg'],
					['smokeDetector.js', 'smokeDetectorVRayCompleteMap.jpg'],
					['curtain1.js', 'curtain1VRayCompleteMap.jpg'],
					['curtain2.js', 'curtain2VRayCompleteMap.jpg'],
					['curtain3.js', 'curtain3VRayCompleteMap.jpg'],
					['curtain4.js', 'curtain4VRayCompleteMap.jpg'],
					['curtain5.js', 'curtain5VRayCompleteMap.jpg'],
					['curtain6.js', 'curtain6VRayCompleteMap.jpg'],
					['mattress.js', 'mattressVRayCompleteMap.jpg'],
					['blanket.js', 'blanketVRayCompleteMap.jpg'],
					['blanket2.js', 'blanket2VRayCompleteMap.jpg'],
					['pillow1.js', 'pillow1VRayCompleteMap.jpg'],
					['pillow2.js', 'pillow2VRayCompleteMap.jpg'],
					['pillow3.js', 'pillow3VRayCompleteMap.jpg'],
					['pillow4.js', 'pillow4VRayCompleteMap.jpg'],
					['pillow5.js', 'pillow5VRayCompleteMap.jpg'],
					// ['sofa.js', 'sofaVRayCompleteMap.jpg'],
					['banquette.js', 'banquetteVRayCompleteMap.jpg'],
					['chair.js', 'chairVRayCompleteMap.jpg'],
					['nightstand.js', 'nightstandVRayCompleteMap.jpg'],
					['table.js', 'tableVRayCompleteMap.jpg'],
					['table2.js', 'table2VRayCompleteMap.jpg'],
					['tvSet.js', 'tvSetVRayCompleteMap.jpg'],
					['book.js', 'bookVRayCompleteMap.jpg'],
					['box.js', 'boxVRayCompleteMap.jpg'],
				];

				parts.forEach(function (part) {
					var loaderJSON = new THREE.JSONLoader(loadingManager);
					var textureLoader = new THREE.TextureLoader(loadingManager);

					loaderJSON.load( part[0], function( geometryJSON ) {
						var texture = textureLoader.load( part[1] );
						var partMesh = new THREE.Mesh( geometryJSON, new THREE.MeshPhongMaterial({ map:texture }) );

						if (part[0] === 'floor.js') {
							var aoMap = textureLoader.load( 'floorVRayShadowMap.jpg' );
							partMesh.material.aoMap = aoMap; // lightMap
							partMesh.scale.set(1000, 1000, 1000);
						}

						meshContainer.add(partMesh);
						partMeshes[part[0].split('.js')[0]] = partMesh;
					} );
				})



				render();
			}

			function wallColorChange(color) {
				var colors = {
					Brown: 'wall-1VRayCompleteMap.jpg',
					Red: 'wall-1RedVRayCompleteMap.jpg',
					Pink: 'wall-1PinkVRayCompleteMap.jpg',
					Blue: 'wall-1BlueVRayCompleteMap.jpg'
				}
				setNewTexture('wall-1', colors[color]);
			}

			function floorgColorChange(color) {
				var colors = {
					Default: 'floorVRayCompleteMap.jpg',
					Green: 'floorGreenVRayCompleteMap.jpg',
					Blue: 'floorBlueVRayCompleteMap.jpg'
				}
				setNewTexture('floor', colors[color]);
			}

			function floorTileChange(tile) {
				var tiles = {
					Default: {
						file: 'floorVRayCompleteMap.jpg',
						sizeX: room.sizeX,
						sizeY: room.sizeY
					},
					A4225_2A: {
						file: 'tiles/A4225_2A.jpg',
						sizeX: 500,
						sizeY: 500
					},
					A4240_3A: {
						file: 'tiles/A4240_3A.jpg',
						sizeX: 500,
						sizeY: 500
					},
					Stone1: {
						file: 'tiles/Stone1.jpg',
						sizeX: 1000,
						sizeY: 1000
					},
					Stone2: {
						file: 'tiles/Stone2.jpg',
						sizeX: 1000,
						sizeY: 1000
					}
				}
				setNewTexture('floor', tiles[tile].file, tiles[tile].sizeX, tiles[tile].sizeY);
			}

			function wallElementChange(color) {
				var colors = {
					Brown: [
						'wall-1-1VRayCompleteMap.jpg',
						'wall-1-2VRayCompleteMap.jpg',
						'wall-1-3VRayCompleteMap.jpg',
						'wall-1-4VRayCompleteMap.jpg',
						'wall-1-5VRayCompleteMap.jpg',
						'wall-1-6VRayCompleteMap.jpg'
					],
					Red: [
						'wall-1-1RedVRayCompleteMap.jpg',
						'wall-1-2RedVRayCompleteMap.jpg',
						'wall-1-3RedVRayCompleteMap.jpg',
						'wall-1-4RedVRayCompleteMap.jpg',
						'wall-1-5RedVRayCompleteMap.jpg',
						'wall-1-6RedVRayCompleteMap.jpg'
					]
				}
				setNewTexture('wall-1-1', colors[color][0]);
				setNewTexture('wall-1-2', colors[color][1]);
				setNewTexture('wall-1-3', colors[color][2]);
				setNewTexture('wall-1-4', colors[color][3]);
				setNewTexture('wall-1-5', colors[color][4]);
				setNewTexture('wall-1-6', colors[color][5]);
			}

			function setNewTexture(objectName, file, sizeX, sizeY) {

				console.log(objectName, file, sizeX, sizeY)
				if (partMeshes[objectName] && file) {
					var textureLoader = new THREE.TextureLoader(loadingManager);
					partMeshes[objectName].material.map = textureLoader.load( file );
					if (sizeX && sizeY) {
						partMeshes[objectName].material.map.wrapS = THREE.RepeatWrapping;
						partMeshes[objectName].material.map.wrapT = THREE.RepeatWrapping;
						partMeshes[objectName].material.map.repeat.set( room.sizeX / sizeX, room.sizeY / sizeY );
					}
				}
			}

			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
				render();
			}

			// function animate() {
			// 	requestAnimationFrame( animate );
			// 	controls.update();
			// 	render();
			// }

			loadingManager.onProgress = function () {
				render();
			}

			function render() {
				renderer.render( scene, camera );
			}
		</script>
	</body>
</html>
