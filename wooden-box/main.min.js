var __extends=(this&&this.__extends)||(function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b);};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __())}})();var View=(function(){function View(containerId){var _this=this;this._animationEnabled=!1;this._rayCaster=new THREE.Raycaster();this._createRenderer(containerId);this._createScene();this._createCamera();window.addEventListener('resize',function(){return _this._onWindowResize()},!1)}
View.prototype.add=function(mesh){this._scene.add(mesh)};View.prototype.getIntersects=function(event,objects,recursive){if(recursive===void 0){recursive=!1}
var normalizedPoint={x:event.offsetX/this.canvas.scrollWidth*2-1,y:-event.offsetY/this.canvas.scrollHeight*2+1,};this._rayCaster.setFromCamera(normalizedPoint,this._camera);return this._rayCaster.intersectObjects(objects||this._scene.children,recursive)};View.prototype.isIntersect=function(objects){if(!Array.isArray(objects)||objects.length===0){return!1}
this._render();var intersects=this._rayCaster.intersectObjects(objects);return intersects.length>0};View.prototype.render=function(){if(this._animationEnabled){return}
this._render()};View.prototype.startAnimation=function(){var _this=this;this._animationEnabled=!0;this._renderer.setAnimationLoop(function(){return _this._render()})};View.prototype.stopAnimation=function(){this._animationEnabled=!1;this._renderer.setAnimationLoop(null)};View.prototype._createCamera=function(){this._camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1000)};View.prototype._createRenderer=function(containerId){this._renderer=new THREE.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0});this._renderer.setPixelRatio(window.devicePixelRatio);this._renderer.setSize(window.innerWidth,window.innerHeight);this._renderer.setClearColor(0xFFFFFF);var container=document.getElementById(containerId);container.appendChild(this._renderer.domElement);this.canvas=this._renderer.domElement};View.prototype._createScene=function(){this._scene=new THREE.Scene()};View.prototype._onWindowResize=function(){this._camera.aspect=window.innerWidth/window.innerHeight;this._camera.updateProjectionMatrix();this._renderer.setSize(window.innerWidth,window.innerHeight);this.render()};View.prototype._render=function(){this._renderer.render(this._scene,this._camera)};return View}());var BoxView=(function(_super){__extends(BoxView,_super);function BoxView(containerId){var _this=_super.call(this,containerId)||this;_this._renderer.setSize(512,512);return _this}
BoxView.prototype.setCameraPosition=function(position){this._camera.position.copy(position);this._camera.lookAt(this._scene.position)};BoxView.prototype._createCamera=function(){this._camera=new THREE.PerspectiveCamera(32,512/512,0.1,10)};BoxView.prototype._onWindowResize=function(){};return BoxView}(View));var BigImage=(function(){function BigImage(){this._canvas=document.createElement('canvas');this._div=document.getElementById('big-container');this._imageSize=512;this._canvasContext=this._canvas.getContext('2d');this._div.appendChild(this._canvas)}
BigImage.prototype.drawImage=function(image){this._currentView=image;this._canvas.width=this._imageSize;this._canvas.height=this._imageSize;this._canvasContext.drawImage(image,0,0,this._imageSize,this._imageSize)};BigImage.prototype.update=function(){this.drawImage(this._currentView)};return BigImage}());var SubView=(function(){function SubView(cameraPosition,view,bigImage){var _this=this;this.canvas=document.createElement('canvas');this._imageSize=512;this.cameraPosition=cameraPosition;this._view=view;this._bigImage=bigImage;this._canvasContext=this.canvas.getContext('2d');this.canvas.addEventListener('click',function(){return _this.drawBigImage()});var div=document.getElementById('sub-containers');div.appendChild(this.canvas)}
SubView.prototype.drawBigImage=function(){this._bigImage.drawImage(this.canvas)};SubView.prototype.update=function(){this.canvas.width=this._imageSize;this.canvas.height=this._imageSize;this._view.setCameraPosition(this.cameraPosition);this._view.render();this._canvasContext.drawImage(this._view.canvas,0,0,this._imageSize,this._imageSize)};return SubView}());var SubViews=(function(){function SubViews(view){var _this=this;this._bigImage=new BigImage();this._viewPositions=[new THREE.Vector3(-0.5,0.5,1),new THREE.Vector3(0,0.5,1),new THREE.Vector3(1,0.5,1),];this._subs=this._viewPositions.map(function(position){return new SubView(position,view,_this._bigImage)});this._subs[0].drawBigImage()}
SubViews.prototype.update=function(){this._subs.forEach(function(sub){return sub.update()});this._bigImage.update()};return SubViews}());var Logos=(function(){function Logos(onclick){this._images=document.querySelectorAll('#logos-container img');this._images.forEach(function(logo){logo.addEventListener('click',function(){return onclick(logo)})})}
return Logos}());var BoxTexture=(function(){function BoxTexture(onLoad){var _this=this;this.texture=null;this._canvas=document.createElement('canvas');this._onLoad=onLoad;this.texture=new THREE.CanvasTexture(this._canvas);this._canvasContext=this._canvas.getContext('2d');this._loadImage();var logos=new Logos(function(image){return _this._drawLogo(image)})}
BoxTexture.prototype._drawLogo=function(image){this._drawTexture(this._image);var left=121;var top=94+25;this._canvasContext.drawImage(image,left,top,image.naturalWidth,image.naturalHeight);this._canvasContext.drawImage(image,left+518,top,image.naturalWidth,image.naturalHeight);this._canvasContext.drawImage(image,left+1032,top,image.naturalWidth,image.naturalHeight);this._canvasContext.drawImage(image,left+1550,top,image.naturalWidth,image.naturalHeight);this.texture.needsUpdate=!0;this._onLoad()};BoxTexture.prototype._drawTexture=function(image){this._canvas.width=image.width;this._canvas.height=image.height;this._canvasContext.drawImage(image,0,0,image.width,image.height)};BoxTexture.prototype._loadImage=function(){var _this=this;var loader=new THREE.ImageLoader();this._image=loader.load('box.jpg',function(image){_this._drawTexture(image);_this._onLoad()})};return BoxTexture}());(function(){document.addEventListener('DOMContentLoaded',function(){var view=new BoxView('main-container');var subViews=new SubViews(view);var loader=new THREE.JSONLoader();loader.load('Box.json',function(geometry){var texture=new BoxTexture(function(){return subViews.update()});var material=new THREE.MeshBasicMaterial({map:texture.texture,});var box=new THREE.Mesh(geometry,material);box.position.y=-0.18;view.add(box)})})})()
